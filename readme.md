# Libre Office шаблоны документов

[![GitHub release](https://img.shields.io/github/release/test-st-petersburg/DocTemplates.svg)](https://github.com/test-st-petersburg/DocTemplates/releases)

Данный проект - Шаблоны внутренних и исходящих документов учреждения.

## Шаблоны документов

### Шаблон "Письмо ФБУ Тест-С.-Петербург"

Данный шаблон подготовлен для целей автоматического заполнения в 1С:Документооборот.
Используется для исходящих документов (писем и прочего) и некоторых внутренних документов
(доверенностей).

Все заполняемые переменные в шаблоне вынесены в раздел "Служебный",
который по умолчанию скрыт.

Всё оформление бланка вынесено в колонтитулы шаблонов страниц.
И обновляется при обновлении стилей из шаблона. По этой причине в колонтитулах
(в шапке и подвале бланка) допустимо использовать только поля,
вычисляемые на основании переменных, заданных вне колонтитулов (в противном случае
их значения будут потеряны при обновлении стилей из шаблона документа).

По умолчанию оформление бланка выводится на печать.
Перед печатью на типографском фирменном следует нажать кнопку "Бланк" на панели
инструментов "Бланки". После этого шапка и подвал бланка по-прежнему отображаются на
экране, но уже не отображаются при просмотре печати, и не выводятся на печать.
Но, данные, выводимые в поля бланка (регистрационные данные, исполнитель и т.д.),
выводятся на печать.

## Подготовка среды

Для внесения изменений в пакет и повторной сборки проекта потребуются следующие продукты:

Под Windows:

- текстовый редактор, настоятельно рекомендую [VSCode][]
- [LibreOffice][]
- [7Zip4Powershell][]
- [Saxon HE][]

Под Linux:

- [PowerShellCore][]
- [VSCode][]
- [LibreOffice][]
- [7Zip4Powershell][]
- [Saxon HE][]

Для [VSCode][] рекомендую установить расширения, указанные в рабочей области.

Существенно удобнее будет работать с репозиторием, имея установленный `git`.

Далее следует скопировать репозиторий проекта либо как zip архив из [последнего
релиза](https://github.com/test-st-petersburg/DocTemplates), либо клонировав
git репозиторий.
Последнее - предпочтительнее.

Для подготовки среды (установки необходимых приложений)
следует воспользоваться сценарием `prepare.ps1` (запускать от имени администратора):

    install\prepare.ps1

Указанный сценарий установит все необходимые компоненты.

## Внесение изменений

Репозиторий проекта размещён по адресу [github.com/test-st-petersburg/DocTemplates](https://github.com/test-st-petersburg/DocTemplates).
Стратегия ветвления - Git Flow.

При необходимости внесения изменений в сам проект предложите Pull Request в основной
репозиторий в ветку `develop`.

[VSCode]: https://code.visualstudio.com/ "Visual Studio Code"
[PowerShellCore]: https://github.com/PowerShell/PowerShell "PowerShell Core"
[LibreOffice]: https://ru.libreoffice.org "Libre Office"
[7Zip4Powershell]: https://github.com/thoemmi/7Zip4Powershell
[Saxon HE]: https://saxonica.com/products/products.xml "Saxon Home Edition"
