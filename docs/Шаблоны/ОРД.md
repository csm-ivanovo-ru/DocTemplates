# Организационно-распорядительная документация ФБУ Ивановский ЦСМ

## Общие сведения

Данный шаблон подготовлен для целей автоматического заполнения в 1С:Документооборот.

Используется для:

- стандартов учреждения
- инструкций системы менеджмента
- положений о подразделениях
- должностных инструкций
- приказов и распоряжений
- служебных, докладных и объяснительных записок
- писем (на фирменном бланке)

## Особенности заполнения

### Общие сведения

Все заполняемые переменные в шаблоне вынесены в раздел "Служебный",
который по умолчанию скрыт.
Указанный раздел является первым разделом документа.

Учитывая ограниченные возможности 1С:Документооборот по заполнению документов,
для автозаполнения используются только строковые переменные.
1С:Документооборот при заполнении не анализирует тип переменной и не изменяет
значение переменной в реквизитах элемента, что приводит к некорректному
определению значения переменной Libre Office для типов, отличных от строкового.

По указанной выше причине даже для предикатов (например - `ЭтоПереписка`)
используется строковый тип.
И в условиях при анализе предиката следует использовать выражение
`ЭтоПереписка EQ "ИСТИНА"`.

По умолчанию оформление бланка выводится на печать.
Перед печатью на типографском фирменном следует нажать кнопку "Бланк" на панели
инструментов "Бланки". После этого шапка и подвал бланка по-прежнему отображаются
на экране, но уже не отображаются при просмотре печати, и не выводятся на печать.
Но данные, выводимые в поля бланка (регистрационные данные, исполнитель и т.д.),
выводятся на печать.

### Заполнение и оформление реквизитов бланка

Всё оформление бланка вынесено в колонтитулы шаблонов страниц.
И обновляется при обновлении стилей из шаблона.
По этой причине в колонтитулах (в шапке и подвале бланка) используются только поля,
вычисляемые на основании переменных, заданных в разделе "Служебный"
(в противном случае их значения будут потеряны при обновлении стилей из шаблона документа).

### Гриф утверждения

При наличии сведений о должностном лице, утверждающем документ,
отображается гриф утверждения.
Указанные сведения должны быть заполнены в следующих переменных:

- `УтвердилДолжностьИП` - должность утверждающего
  без указания организации в именительном падеже
- `УтвердилПредставлениеВПодписиИП` - инициалы и фамилия (И.И. Иванов)
  утверждающего в именительном падеже

Дата утверждения должна совпадать с датой регистрации документа
(см. п. 5.10 ГОСТ Р 7.0.97-2016).

Так же гриф утверждения не выводится при подготовке документа,
содержащего переписку (переменная `ЭтоПереписка` содержит
строку `"Истина"`)

## Сведения для разработчиков

### Печать на бланке

По умолчанию оформление бланка выводится на печать.
Перед печатью на типографском фирменном следует нажать кнопку "Бланк" на панели
инструментов "Бланки". После этого шапка и подвал бланка по-прежнему отображаются
на экране, но уже не отображаются при просмотре печати, и не выводятся на печать.

Реализован механизм сокрытия элементов при печати на бланке с помощью
макрокоманды `prepareForPrintingOnLetterhead`.
Для этих целей используется свойство врезок "Выводить на печать".
Указанная выше макрокоманда для всех врезок, наименование которых начинается с
"Бланк:", отключает вывод на печать.
Обратная макрокоманда `prepareForPrintingOnPaper` так же
для всех врезок, наименование которых начинается с
"Бланк:", включает вывод на печать.

При необходимости включения дополнительного оформления бланка достаточно
добавить новую врезку, изменить её наименование (например: "Бланк: ещё
один элемент бланка"), заполнить её необходимым оформлением.
После чего вывод её (врезки) на печать так же будет управляться указанными
выше макрокомандами и кнопками "Бланк", "Бумага".
