# Письмо ФБУ Тест-С.-Петербург

## Общие сведения

Данный шаблон подготовлен для целей автоматического заполнения в 1С:Документооборот.
Используется для исходящих документов (писем).

Все заполняемые переменные в шаблоне вынесены в раздел "Служебный",
который по умолчанию скрыт.

Всё оформление бланка вынесено в колонтитулы шаблонов страниц.
И обновляется при обновлении стилей из шаблона. По этой причине в колонтитулах
(в шапке и подвале бланка) допустимо использовать только поля,
вычисляемые на основании переменных, заданных вне колонтитулов (в противном случае
их значения будут потеряны при обновлении стилей из шаблона документа).

По умолчанию оформление бланка выводится на печать.
Перед печатью на типографском фирменном следует нажать кнопку "Бланк" на панели
инструментов "Бланки". После этого шапка и подвал бланка по-прежнему отображаются
на экране, но уже не отображаются при просмотре печати, и не выводятся на печать.
Но данные, выводимые в поля бланка (регистрационные данные, исполнитель и т.д.),
выводятся на печать.

## Характеристики

- может использоваться для создания документов

## Сведения для разработчиков

### Печать на бланке

По умолчанию оформление бланка выводится на печать.
Перед печатью на типографском фирменном следует нажать кнопку "Бланк" на панели
инструментов "Бланки". После этого шапка и подвал бланка по-прежнему отображаются
на экране, но уже не отображаются при просмотре печати, и не выводятся на печать.

Реализован механизм сокрытия элементов при печати на бланке с помощью
макрокоманды `prepareForPrintingOnLetterhead`.
Для этих целей используется свойство врезок "Выводить на печать".
Указанная выше макрокоманда для всех врезок, наименование которых начинается с
"Бланк:", отключает вывод на печать.
Обратная макрокоманда `prepareForPrintingOnPaper` так же
для всех врезок, наименование которых начинается с
"Бланк:", включает вывод на печать.

При необходимости включения дополнительного оформления бланка достаточно
добавить новую врезку, изменить её наименование (например: "Бланк: ещё
один элемент бланка"), заполнить её необходимым оформлением.
После чего вывод её (врезки) на печать так же будет управляться указанными
выше макрокомандами и кнопками "Бланк", "Бумага".

## Журнал изменений

### 1.6.11

Исправлены ошибки:

- поле Получатель в письме не укладывается в поля бланка
  [#55](https://github.com/test-st-petersburg/DocTemplates/issues/55)

### 1.6.10

Исправлены ошибки:

- переносы не должны допускаться в поле Получатель в Письмах
  [#54](https://github.com/test-st-petersburg/DocTemplates/issues/54)

### 1.6.6

Исправлены ошибки:

- восстановлено обновление стилей из шаблона документа при открытии документа
  (выдаётся запрос на обновление в случае изменения шаблона с последнего
  сохранения документа, #44)

### 1.6.2

Исправлены ошибки:

- исправлен иерархический список

### 1.4.0

Прочие изменения:

- переоформлены поля с данными с помощью подстрочника,
  исключено использование таблиц, по возможности

### 1.3.0

Новые возможности:

- для условного отображения вида документа в шапке при обновлении
  стилей из шаблона подключены макрокоманды, выполняемые при открытии и
  создании документа

Прочие изменения:

- переименованы стили (убрано наименование документа, утвердившего формы бланков)

### 1.2.0

Исправлены ошибки:

- оформление бланка Письма полностью перенесено в колонтитулы,
  что позволяет при обновлении стилей полностью обновлять оформление бланка
- устранена потеря данных в шапке и подвале бланка Письма при обновлении
  стилей из шаблона (все переменные перенесены в служебную страницу)

Прочие изменения:

- Шаблон Записка переименован в Письмо

### 1.1.0

Исправлены ошибки:

- внедрены шрифты в шаблоны документов
