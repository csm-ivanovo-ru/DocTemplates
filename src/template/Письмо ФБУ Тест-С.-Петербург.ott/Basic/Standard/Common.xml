<?xml version="1.0" encoding="UTF-8"?><script:module xmlns:script="http://openoffice.org/2000/script" script:name="Common" script:language="StarBasic" script:moduleType="normal">
REM  *****  BASIC  *****

rem ----------------------------------------------------------------------
rem Установка значение переменных документа
rem ----------------------------------------------------------------------
sub setDocVariableValue(ByVal name as string, ByVal value)
	dim document as object
	dim textField as object
	dim fieldId as string
	
	document   = ThisComponent

	fieldId = "com.sun.star.text.fieldmaster.SetExpression" + "." + name
	if document.TextFieldMasters.hasByName(fieldId) then
		for each textField in document.TextFieldMasters.getByName(fieldId).dependentTextFields
			textField.Content = value
		next
	end if
	
	document.getTextFields().refresh()

end sub
</script:module>